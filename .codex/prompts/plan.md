---
description:
  Execute the implementation planning workflow using the plan template to
  generate design artifacts.
---

The user input to you can be provided directly by the agent or as a command
argument - you **MUST** consider it before proceeding with the prompt (if not
empty).

User input:

$ARGUMENTS

Given the implementation details provided as an argument, do this:

1. Load Spec Kit configuration:
   - Check for `/.specify.yaml` at the host project root; if it exists, load
     that file
   - Otherwise load `.specify/config-default.yaml`
   - Extract the root `spec-kit` entry and store it as `SPEC_KIT_CONFIG`
   - Output the resulting `SPEC_KIT_CONFIG` for operator visibility

2. Run `.specify/scripts/bash/setup-plan.sh --json` from the repo root (the
   setup script automatically chooses the appropriate plan template based on
   repository context and any command arguments) and parse JSON for
   FEATURE_SPEC, IMPL_PLAN, SPECS_DIR, BRANCH. All future file paths must be
   absolute.
   - BEFORE proceeding, inspect FEATURE_SPEC for a `## Clarifications` section
     with at least one `Session` subheading. If missing or clearly ambiguous
     areas remain (vague adjectives, unresolved critical choices), PAUSE and
     instruct the user to run `/clarify` first to reduce rework. Only continue
     if: (a) Clarifications exist OR (b) an explicit user override is provided
     (e.g., "proceed without clarification"). Do not attempt to fabricate
     clarifications yourself.

3. Read and analyze the feature specification to understand:
   - The feature requirements and user stories
   - Functional and non-functional requirements
   - Success criteria and acceptance criteria
   - Any technical constraints or dependencies mentioned

4. If defined, read documents from `SPEC_KIT_CONFIG.plan.documents`:
   - For each item, resolve `path` to an absolute path from the repo root
   - Read the file and consider its `context` to guide planning decisions
   - If a file is missing, note it and continue

5. Read the constitution at the path specified by
   `SPEC_KIT_CONFIG.constitution.path` to understand constitutional
   requirements.

6. Execute the implementation plan template copied to `IMPL_PLAN`:
   - Load the template file at `IMPL_PLAN` (already prepared by the setup
     script).
   - Set Input path to FEATURE_SPEC.
   - Run the Execution Flow steps defined by the template.
   - Follow template-specific error handling and gate checks.
   - Let the template guide artifact generation in $SPECS_DIR:
     - Phase 0 produces research.md when required.
     - Phase 1 produces data-model.md, contracts/, quickstart.md, and agent
       files aligned with existing structure.
     - Phase 2 documents the task planning approach; actual tasks.md is
       generated by the /tasks command.
   - Incorporate user-provided details from arguments into Technical Context:
     $ARGUMENTS.
   - Update Progress Tracking as you complete each phase.

7. Verify execution completed:
   - Check Progress Tracking reflects /plan phases complete.
   - Ensure all required artifacts were generated at the expected locations.
   - Confirm no ERROR states in execution.

8. Report results with branch name, file paths, and generated artifacts.

Use absolute paths with the repository root for all file operations to avoid
path issues.
